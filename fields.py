#!/usr/bin/env python
'''This is a demo on how to use Gnuplot for potential fields.  We've
intentionally avoided "giving it all away."
'''

from __future__ import division
from itertools import cycle

try:
    from numpy import linspace
except ImportError:
    # This is stolen from numpy.  If numpy is installed, you don't
    # need this:
    def linspace(start, stop, num=50, endpoint=True, retstep=False):
        """Return evenly spaced numbers.

        Return num evenly spaced samples from start to stop.  If
        endpoint is True, the last sample is stop. If retstep is
        True then return the step value used.
        """
        num = int(num)
        if num <= 0:
            return []
        if endpoint:
            if num == 1:
                return [float(start)]
            step = (stop-start)/float((num-1))
            y = [x * step + start for x in xrange(0, num - 1)]
            y.append(stop)
        else:
            step = (stop-start)/float(num)
            y = [x * step + start for x in xrange(0, num)]
        if retstep:
            return y, step
        else:
            return y


########################################################################
# Constants

# Output file:
FILENAME = 'fields.gpi'
# Size of the world (one of the "constants" in bzflag):
WORLDSIZE = 800
# How many samples to take along each dimension:
SAMPLES = 25
# Change spacing by changing the relative length of the vectors.  It looks
# like scaling by 0.75 is pretty good, but this is adjustable:
VEC_LEN = 0.75 * WORLDSIZE / SAMPLES
# Animation parameters:
ANIMATION_MIN = 0
ANIMATION_MAX = 500
ANIMATION_FRAMES = 50


########################################################################
# Field and Obstacle Definitions

def generate_field_function(scale):
    def function(x, y):
        '''User-defined field function.'''
        sqnorm = (x**2 + y**2)
        if sqnorm == 0.0:
            return 0, 0
        else:
            return x*scale/sqnorm, y*scale/sqnorm
    return function

POINTS = [((-400, -400), (-0.0015299, 35000)),
((-400, -375), (-0.00142062, 32500)),
((-400, -350), (-0.00131134, 30000)),
((-400, -325), (-0.00120206, 27500)),
((-400, -300), (-0.00109278, 25000)),
((-400, -275), (-0.000983506, 22500)),
((-400, -250), (-0.000874228, 20000)),
((-400, -225), (-0.000764949, 17500)),
((-400, -200), (-0.000655671, 15000)),
((-400, -175), (-0.000546392, 12500)),
((-400, -150), (-0.000437114, 10000)),
((-400, -125), (-0.000327835, 7500)),
((-400, -100), (-0.000218557, 5000)),
((-400, -75), (-0.000109278, 2500)),
((-400, -50), (0, 4.02408e-34)),
((-400, -25), (0, 4.02408e-34)),
((-400, 0), (-4.37114e-05, -1000)),
((-400, 25), (-0.00015299, -3500)),
((-400, 50), (-0.000262268, -6000)),
((-400, 75), (-0.000371547, -8500)),
((-400, 100), (-0.000480825, -11000)),
((-400, 125), (-0.000590104, -13500)),
((-400, 150), (-0.000699382, -16000)),
((-400, 175), (-0.000808661, -18500)),
((-400, 200), (-0.000917939, -21000)),
((-400, 225), (-0.00102722, -23500)),
((-400, 250), (-0.0011365, -26000)),
((-400, 275), (-0.00124577, -28500)),
((-400, 300), (-0.00135505, -31000)),
((-400, 325), (-0.00146433, -33500)),
((-400, 350), (-0.00157361, -36000)),
((-400, 375), (-0.00168289, -38500)),
((-400, 400), (-0.00179217, -41000)),
((-375, -400), (-2365.17, 35004.6)),
((-375, -375), (-2355.45, 32505.2)),
((-375, -350), (-2344.22, 30006.1)),
((-375, -325), (-2331.11, 27507.1)),
((-375, -300), (-2315.6, 25008.5)),
((-375, -275), (-2296.97, 22510.3)),
((-375, -250), (-2274.18, 20012.8)),
((-375, -225), (-2245.67, 17516.2)),
((-375, -200), (-2209.01, 15021.3)),
((-375, -175), (-2160.19, 12529.1)),
((-375, -150), (-2092.09, 10042)),
((-375, -125), (-1991.01, 7565.85)),
((-375, -100), (-1827.33, 5116.52)),
((-375, -75), (-1528.71, 2751.69)),
((-375, -50), (-938.262, 750.61)),
((-375, -25), (-538.839, -107.768)),
((-375, 0), (-1219.63, -1463.56)),
((-375, 25), (-1672.39, -3679.27)),
((-375, 50), (-1903.45, -6091.04)),
((-375, 75), (-2036.76, -8554.39)),
((-375, 100), (-2122.31, -11036)),
((-375, 125), (-2181.54, -13525.5)),
((-375, 150), (-2224.86, -16019)),
((-375, 175), (-2257.89, -18514.7)),
((-375, 200), (-2283.88, -21011.7)),
((-375, 225), (-2304.86, -23509.5)),
((-375, 250), (-2322.14, -26007.9)),
((-375, 275), (-2336.61, -28506.7)),
((-375, 300), (-2348.92, -31005.7)),
((-375, 325), (-2359.5, -33504.9)),
((-375, 350), (-2368.71, -36004.3)),
((-375, 375), (-2376.78, -38503.8)),
((-375, 400), (-2383.92, -41003.4)),
((-350, -400), (-4732.17, 35018)),
((-350, -375), (-4713.14, 32520.7)),
((-350, -350), (-4691.25, 30024)),
((-350, -325), (-4665.78, 27528.1)),
((-350, -300), (-4635.82, 25033.4)),
((-350, -275), (-4600.08, 22540.4)),
((-350, -250), (-4556.76, 20049.7)),
((-350, -225), (-4503.25, 17562.7)),
((-350, -200), (-4435.67, 15081.3)),
((-350, -175), (-4348.02, 12609.3)),
((-350, -150), (-4230.77, 10153.8)),
((-350, -125), (-4068.51, 7730.16)),
((-350, -100), (-3837.52, 5372.53)),
((-350, -75), (-3513.41, 3162.07)),
((-350, -50), (-3143.05, 1257.22)),
((-350, -25), (-3009.93, -300.993)),
((-350, 0), (-3285.01, -1971.01)),
((-350, 25), (-3654.65, -4020.12)),
((-350, 50), (-3940, -6304)),
((-350, 75), (-4140.13, -8694.28)),
((-350, 100), (-4282.04, -11133.3)),
((-350, 125), (-4385.99, -13596.6)),
((-350, 150), (-4464.71, -16073)),
((-350, 175), (-4526.09, -18557)),
((-350, 200), (-4575.14, -21045.6)),
((-350, 225), (-4615.17, -23537.4)),
((-350, 250), (-4648.42, -26031.1)),
((-350, 275), (-4676.45, -28526.3)),
((-350, 300), (-4700.39, -31022.6)),
((-350, 325), (-4721.06, -33519.5)),
((-350, 350), (-4739.09, -36017.1)),
((-350, 375), (-4754.95, -38515.1)),
((-350, 400), (-4769, -41013.4)),
((-325, -400), (-7102.67, 35039.9)),
((-325, -375), (-7075.14, 32545.6)),
((-325, -350), (-7043.62, 30052.8)),
((-325, -325), (-7007.2, 27561.7)),
((-325, -300), (-6964.71, 25073)),
((-325, -275), (-6914.57, 22587.6)),
((-325, -250), (-6854.65, 20107)),
((-325, -225), (-6782.04, 17633.3)),
((-325, -200), (-6692.72, 15170.2)),
((-325, -175), (-6581.15, 12723.6)),
((-325, -150), (-6440, 10304)),
((-325, -125), (-6260.71, 7930.24)),
((-325, -100), (-6037.89, 5635.36)),
((-325, -75), (-5785.01, 3471.01)),
((-325, -50), (-5567.53, 1484.67)),
((-325, -25), (-5504.43, -366.961)),
((-325, 0), (-5643.05, -2257.22)),
((-325, 25), (-5887.19, -4317.27)),
((-325, 50), (-6132.12, -6540.93)),
((-325, 75), (-6337.52, -8872.53)),
((-325, 100), (-6500.56, -11267.6)),
((-325, 125), (-6628.88, -13699.7)),
((-325, 150), (-6730.77, -16153.8)),
((-325, 175), (-6812.84, -18621.8)),
((-325, 200), (-6879.96, -21098.5)),
((-325, 225), (-6935.67, -23581.3)),
((-325, 250), (-6982.53, -26068.1)),
((-325, 275), (-7022.42, -28557.9)),
((-325, 300), (-7056.76, -31049.7)),
((-325, 325), (-7086.59, -33543.2)),
((-325, 350), (-7112.73, -36037.8)),
((-325, 375), (-7135.82, -38533.4)),
((-325, 400), (-7156.35, -41029.7)),
((-300, -400), (-9478.18, 35069.3)),
((-300, -375), (-9443.21, 32579.1)),
((-300, -350), (-9403.45, 30091)),
((-300, -325), (-9357.92, 27605.9)),
((-300, -300), (-9305.37, 25124.5)),
((-300, -275), (-9244.21, 22648.3)),
((-300, -250), (-9172.39, 20179.3)),
((-300, -225), (-9087.37, 17720.4)),
((-300, -200), (-8985.96, 15276.1)),
((-300, -175), (-8864.54, 12853.6)),
((-300, -150), (-8719.63, 10463.6)),
((-300, -125), (-8550, 8122.5)),
((-300, -100), (-8361.54, 5853.08)),
((-300, -75), (-8176.16, 3679.27)),
((-300, -50), (-8038.84, 1607.77)),
((-300, -25), (-8002.5, -400.125)),
((-300, 0), (-8084.35, -2425.3)),
((-300, 25), (-8247.57, -4536.16)),
((-300, 50), (-8438.26, -6750.61)),
((-300, 75), (-8620.69, -9051.72)),
((-300, 100), (-8780.58, -11414.8)),
((-300, 125), (-8915.75, -13819.4)),
((-300, 150), (-9028.72, -16251.7)),
((-300, 175), (-9123.15, -18702.5)),
((-300, 200), (-9202.55, -21165.9)),
((-300, 225), (-9269.82, -23638.1)),
((-300, 250), (-9327.33, -26116.5)),
((-300, 275), (-9376.9, -28599.5)),
((-300, 300), (-9419.99, -31086)),
((-300, 325), (-9457.72, -33574.9)),
((-300, 350), (-9491.01, -36065.9)),
((-300, 375), (-9520.57, -38558.3)),
((-300, 400), (-9546.97, -41052)),
((-275, -400), (-11859.9, 35105.2)),
((-275, -375), (-11818.7, 32619.6)),
((-275, -350), (-11772.3, 30137.1)),
((-275, -325), (-11719.7, 27658.5)),
((-275, -300), (-11659.8, 25185.1)),
((-275, -275), (-11591.1, 22718.5)),
((-275, -250), (-11512, 20261.1)),
((-275, -225), (-11420.7, 17816.2)),
((-275, -200), (-11315.2, 15388.7)),
((-275, -175), (-11194.1, 12985.2)),
((-275, -150), (-11057.2, 10614.9)),
((-275, -125), (-10907.7, 8289.83)),
((-275, -100), (-10755, 6022.79)),
((-275, -75), (-10618.2, 3822.56)),
((-275, -50), (-10525.1, 1684.02)),
((-275, -25), (-10501.6, -420.064)),
((-275, 0), (-10555.2, -2533.26)),
((-275, 25), (-10669.4, -4694.52)),
((-275, 50), (-10815.5, -6921.89)),
((-275, 75), (-10968.6, -9213.62)),
((-275, 100), (-11113.8, -11558.3)),
((-275, 125), (-11244.5, -13943.2)),
((-275, 150), (-11359.2, -16357.3)),
((-275, 175), (-11458.8, -18792.4)),
((-275, 200), (-11545, -21242.7)),
((-275, 225), (-11619.7, -23704.2)),
((-275, 250), (-11684.7, -26173.7)),
((-275, 275), (-11741.6, -28649.4)),
((-275, 300), (-11791.5, -31129.7)),
((-275, 325), (-11835.8, -33613.5)),
((-275, 350), (-11875.1, -36100.1)),
((-275, 375), (-11910.2, -38588.9)),
((-275, 400), (-11941.7, -41079.5)),
((-250, -400), (-14248.6, 35146.5)),
((-250, -375), (-14202.5, 32665.9)),
((-250, -350), (-14151.1, 30189.1)),
((-250, -325), (-14093.5, 27717.2)),
((-250, -300), (-14028.7, 25251.7)),
((-250, -275), (-13955.7, 22794.3)),
((-250, -250), (-13873.3, 20347.5)),
((-250, -225), (-13780.6, 17914.8)),
((-250, -200), (-13676.8, 15500.3)),
((-250, -175), (-13562, 13110)),
((-250, -150), (-13438.3, 10750.6)),
((-250, -125), (-13310.4, 8429.9)),
((-250, -100), (-13187.6, 6154.23)),
((-250, -75), (-13084.3, 3925.3)),
((-250, -50), (-13017.5, 1735.67)),
((-250, -25), (-13001.1, -433.371)),
((-250, 0), (-13038.8, -2607.77)),
((-250, 25), (-13122.2, -4811.49)),
((-250, 50), (-13235.3, -7058.82)),
((-250, 75), (-13361.5, -9353.08)),
((-250, 100), (-13488.6, -11690.1)),
((-250, 125), (-13609.2, -14062.8)),
((-250, 150), (-13719.6, -16463.6)),
((-250, 175), (-13819, -18885.9)),
((-250, 200), (-13907.5, -21324.8)),
((-250, 225), (-13986, -23776.1)),
((-250, 250), (-14055.6, -26237)),
((-250, 275), (-14117.4, -28705.3)),
((-250, 300), (-14172.4, -31179.3)),
((-250, 325), (-14221.6, -33657.7)),
((-250, 350), (-14265.7, -36139.7)),
((-250, 375), (-14305.4, -38624.5)),
((-250, 400), (-14341.3, -41111.6)),
((-225, -400), (-16644.9, 35192)),
((-225, -375), (-16595.2, 32716.3)),
((-225, -350), (-16540.4, 30245.3)),
((-225, -325), (-16479.6, 27779.9)),
((-225, -300), (-16412.2, 25321.7)),
((-225, -275), (-16337.5, 22872.5)),
((-225, -250), (-16255, 20434.8)),
((-225, -225), (-16164.2, 18011.5)),
((-225, -200), (-16065.4, 15606.4)),
((-225, -175), (-15960, 13224)),
((-225, -150), (-15850.5, 10868.9)),
((-225, -125), (-15742.3, 8545.82)),
((-225, -100), (-15643, 6257.22)),
((-225, -75), (-15563, 4001.92)),
((-225, -50), (-15512.9, 1772.91)),
((-225, -25), (-15500.8, -442.88)),
((-225, 0), (-15528.8, -2662.07)),
((-225, 25), (-15592, -4900.35)),
((-225, 50), (-15681, -7168.48)),
((-225, 75), (-15785, -9471.01)),
((-225, 100), (-15894.5, -11807.4)),
((-225, 125), (-16002.8, -14173.9)),
((-225, 150), (-16105.8, -16566)),
((-225, 175), (-16201.5, -18978.9)),
((-225, 200), (-16289, -21408.3)),
((-225, 225), (-16368.3, -23851)),
((-225, 250), (-16440, -26304)),
((-225, 275), (-16504.7, -28765.3)),
((-225, 300), (-16563, -31233.1)),
((-225, 325), (-16615.7, -33706.1)),
((-225, 350), (-16663.4, -36183.4)),
((-225, 375), (-16706.7, -38664.1)),
((-225, 400), (-16746.1, -41147.5)),
((-200, -400), (-19049, 35240.6)),
((-200, -375), (-18996.9, 32769.7)),
((-200, -350), (-18940, 30304)),
((-200, -325), (-18877.7, 27844.6)),
((-200, -300), (-18809.5, 25392.9)),
((-200, -275), (-18735.2, 22950.7)),
((-200, -250), (-18654.7, 20520.1)),
((-200, -225), (-18568, 18103.8)),
((-200, -200), (-18476.1, 15704.7)),
((-200, -175), (-18380.8, 13326.1)),
((-200, -150), (-18285, 10971)),
((-200, -125), (-18193.4, 8641.88)),
((-200, -100), (-18112.3, 6339.3)),
((-200, -75), (-18048.8, 4060.97)),
((-200, -50), (-18009.9, 1800.99)),
((-200, -25), (-18000.6, -450.015)),
((-200, 0), (-18022.1, -2703.32)),
((-200, 25), (-18071.6, -4969.69)),
((-200, 50), (-18143, -7257.22)),
((-200, 75), (-18229.2, -9570.33)),
((-200, 100), (-18323.1, -11910)),
((-200, 125), (-18419.2, -14274.9)),
((-200, 150), (-18513.4, -16662.1)),
((-200, 175), (-18603.4, -19068.4)),
((-200, 200), (-18687.6, -21490.8)),
((-200, 225), (-18765.7, -23926.3)),
((-200, 250), (-18837.5, -26372.5)),
((-200, 275), (-18903.3, -28827.5)),
((-200, 300), (-18963.4, -31289.6)),
((-200, 325), (-19018.3, -33757.5)),
((-200, 350), (-19068.5, -36230.2)),
((-200, 375), (-19114.4, -38706.7)),
((-200, 400), (-19156.5, -41186.6)),
((-175, -400), (-21460.8, 35291.2)),
((-175, -375), (-21407.5, 32824.8)),
((-175, -350), (-21349.7, 30363.9)),
((-175, -325), (-21287.1, 27909.8)),
((-175, -300), (-21219.6, 25463.6)),
((-175, -275), (-21147.2, 23026.9)),
((-175, -250), (-21070, 20601.8)),
((-175, -225), (-20988.6, 18190.1)),
((-175, -200), (-20904.3, 15794.3)),
((-175, -175), (-20818.9, 13416.6)),
((-175, -150), (-20735.3, 11058.8)),
((-175, -125), (-20657.5, 8722.06)),
((-175, -100), (-20590.3, 6405.87)),
((-175, -75), (-20538.8, 4107.77)),
((-175, -50), (-20507.9, 1822.92)),
((-175, -25), (-20500.5, -455.568)),
((-175, 0), (-20517.5, -2735.67)),
((-175, 25), (-20557.2, -5025.09)),
((-175, 50), (-20615.6, -7329.98)),
((-175, 75), (-20687.6, -9654.23)),
((-175, 100), (-20768.3, -11999.4)),
((-175, 125), (-20853, -14365.4)),
((-175, 150), (-20938.3, -16750.6)),
((-175, 175), (-21021.6, -19153)),
((-175, 200), (-21101.4, -21570.3)),
((-175, 225), (-21176.8, -24000.3)),
((-175, 250), (-21247.2, -26441)),
((-175, 275), (-21312.7, -28890.6)),
((-175, 300), (-21373.3, -31347.5)),
((-175, 325), (-21429.3, -33810.7)),
((-175, 350), (-21481, -36279.1)),
((-175, 375), (-21528.7, -38751.7)),
((-175, 400), (-21572.8, -41227.9)),
((-150, -400), (-23880.3, 35342.8)),
((-150, -375), (-23826.4, 32880.5)),
((-150, -350), (-23768.7, 30424)),
((-150, -325), (-23707, 27974.2)),
((-150, -300), (-23641.2, 25532.5)),
((-150, -275), (-23571.6, 23100.1)),
((-150, -250), (-23498.6, 20678.7)),
((-150, -225), (-23423, 18269.9)),
((-150, -200), (-23346.1, 15875.4)),
((-150, -175), (-23269.9, 13496.6)),
((-150, -150), (-23197, 11134.5)),
((-150, -125), (-23130.4, 8789.56)),
((-150, -100), (-23074.1, 6460.74)),
((-150, -75), (-23031.6, 4145.69)),
((-150, -50), (-23006.4, 1840.51)),
((-150, -25), (-23000.4, -460.007)),
((-150, 0), (-23014.2, -2761.71)),
((-150, 25), (-23046.7, -5070.28)),
((-150, 50), (-23095.2, -7390.45)),
((-150, 75), (-23156, -9725.54)),
((-150, 100), (-23225.6, -12077.3)),
((-150, 125), (-23300.2, -14446.1)),
((-150, 150), (-23376.9, -16831.4)),
((-150, 175), (-23453.5, -19231.8)),
((-150, 200), (-23528.1, -21645.9)),
((-150, 225), (-23599.9, -24071.8)),
((-150, 250), (-23668, -26508.1)),
((-150, 275), (-23732.1, -28953.2)),
((-150, 300), (-23792.3, -31405.8)),
((-150, 325), (-23848.4, -33864.8)),
((-150, 350), (-23900.8, -36329.2)),
((-150, 375), (-23949.5, -38798.1)),
((-150, 400), (-23994.8, -41271)),
((-125, -400), (-26307, 35394.8)),
((-125, -375), (-26253.4, 32936.1)),
((-125, -350), (-26196.5, 30483.2)),
((-125, -325), (-26136.2, 28037.1)),
((-125, -300), (-26072.9, 25598.8)),
((-125, -275), (-26006.7, 23169.6)),
((-125, -250), (-25938.3, 20750.6)),
((-125, -225), (-25868.5, 18343.1)),
((-125, -200), (-25798.8, 15948.4)),
((-125, -175), (-25730.9, 13567.2)),
((-125, -150), (-25666.9, 11200.1)),
((-125, -125), (-25609.6, 8846.96)),
((-125, -100), (-25561.8, 6506.64)),
((-125, -75), (-25526.2, 4177.03)),
((-125, -50), (-25505.3, 1854.93)),
((-125, -25), (-25500.3, -463.642)),
((-125, 0), (-25511.8, -2783.11)),
((-125, 25), (-25538.8, -5107.77)),
((-125, 50), (-25579.6, -7441.34)),
((-125, 75), (-25631.6, -9786.6)),
((-125, 100), (-25691.9, -12145.2)),
((-125, 125), (-25757.7, -14518)),
((-125, 150), (-25826.6, -16904.7)),
((-125, 175), (-25896.5, -19304.7)),
((-125, 200), (-25965.8, -21716.9)),
((-125, 225), (-26033.5, -24140.1)),
((-125, 250), (-26098.6, -26573.1)),
((-125, 275), (-26160.7, -29014.6)),
((-125, 300), (-26219.6, -31463.6)),
((-125, 325), (-26275.2, -33918.9)),
((-125, 350), (-26327.5, -36379.8)),
((-125, 375), (-26376.5, -38845.4)),
((-125, 400), (-26422.5, -41315.1)),
((-100, -400), (-28740.4, 35446.5)),
((-100, -375), (-28687.6, 32990.8)),
((-100, -350), (-28632.1, 30540.9)),
((-100, -325), (-28573.9, 28097.7)),
((-100, -300), (-28513.4, 25662.1)),
((-100, -275), (-28450.9, 23234.9)),
((-100, -250), (-28387.2, 20817.3)),
((-100, -225), (-28323.1, 18410)),
((-100, -200), (-28260, 16014)),
((-100, -175), (-28199.3, 13629.7)),
((-100, -150), (-28143, 11257.2)),
((-100, -125), (-28093.3, 8896.22)),
((-100, -100), (-28052.3, 6545.54)),
((-100, -75), (-28022.1, 4203.32)),
((-100, -50), (-28004.4, 1866.96)),
((-100, -25), (-28000.3, -466.672)),
((-100, 0), (-28009.9, -2800.99)),
((-100, 25), (-28032.8, -5139.35)),
((-100, 50), (-28067.5, -7484.67)),
((-100, 75), (-28112.3, -9839.3)),
((-100, 100), (-28164.9, -12204.8)),
((-100, 125), (-28223.1, -14582)),
((-100, 150), (-28285, -16971)),
((-100, 175), (-28348.7, -19371.6)),
((-100, 200), (-28412.8, -21783.1)),
((-100, 225), (-28476.1, -24204.7)),
((-100, 250), (-28537.9, -26635.4)),
((-100, 275), (-28597.5, -29074.1)),
((-100, 300), (-28654.7, -31520.1)),
((-100, 325), (-28709.1, -33972.4)),
((-100, 350), (-28760.7, -36430.2)),
((-100, 375), (-28809.5, -38892.9)),
((-100, 400), (-28855.6, -41359.7)),
((-75, -400), (-31180.1, 35497.4)),
((-75, -375), (-31128.6, 33044.2)),
((-75, -350), (-31074.9, 30596.8)),
((-75, -325), (-31019.1, 28155.8)),
((-75, -300), (-30961.6, 25722)),
((-75, -275), (-30903, 23296.1)),
((-75, -250), (-30843.8, 20878.9)),
((-75, -225), (-30785, 18471)),
((-75, -200), (-30727.8, 16073)),
((-75, -175), (-30673.5, 13685.1)),
((-75, -150), (-30623.8, 11307.3)),
((-75, -125), (-30580.3, 8938.87)),
((-75, -100), (-30544.8, 6578.89)),
((-75, -75), (-30518.9, 4225.69)),
((-75, -50), (-30503.8, 1877.15)),
((-75, -25), (-30500.2, -469.234)),
((-75, 0), (-30508.5, -2816.17)),
((-75, 25), (-30528, -5166.29)),
((-75, 50), (-30558, -7521.96)),
((-75, 75), (-30596.9, -9885.14)),
((-75, 100), (-30643, -12257.2)),
((-75, 125), (-30694.8, -14639.1)),
((-75, 150), (-30750.4, -17031)),
((-75, 175), (-30808.4, -19433)),
((-75, 200), (-30867.5, -21844.7)),
((-75, 225), (-30926.5, -24265.4)),
((-75, 250), (-30984.8, -26694.6)),
((-75, 275), (-31041.6, -29131.4)),
((-75, 300), (-31096.6, -31575)),
((-75, 325), (-31149.5, -34024.8)),
((-75, 350), (-31200.1, -36480.1)),
((-75, 375), (-31248.3, -38940.1)),
((-75, 400), (-31294.1, -41404.5)),
((-50, -400), (-33625.6, 35547.1)),
((-50, -375), (-33575.6, 33096)),
((-50, -350), (-33523.9, 30650.5)),
((-50, -325), (-33470.7, 28211.1)),
((-50, -300), (-33416.4, 25778.4)),
((-50, -275), (-33361.5, 23353.1)),
((-50, -250), (-33306.7, 20935.7)),
((-50, -225), (-33252.9, 18526.6)),
((-50, -200), (-33201, 16126.2)),
((-50, -175), (-33152.3, 13734.5)),
((-50, -150), (-33108.1, 11351.4)),
((-50, -125), (-33069.8, 8976.1)),
((-50, -100), (-33038.8, 6607.77)),
((-50, -75), (-33016.3, 4244.96)),
((-50, -50), (-33003.3, 1885.9)),
((-50, -25), (-33000.2, -471.432)),
((-50, 0), (-33007.3, -2829.2)),
((-50, 25), (-33024.2, -5189.52)),
((-50, 50), (-33050.3, -7554.35)),
((-50, 75), (-33084.3, -9925.31)),
((-50, 100), (-33125.1, -12303.6)),
((-50, 125), (-33171.3, -14690.2)),
((-50, 150), (-33221.4, -17085.3)),
((-50, 175), (-33274.2, -19489.2)),
((-50, 200), (-33328.6, -21901.6)),
((-50, 225), (-33383.5, -24322.3)),
((-50, 250), (-33438.3, -26750.6)),
((-50, 275), (-33492.2, -29186)),
((-50, 300), (-33544.8, -31628)),
((-50, 325), (-33595.9, -34075.8)),
((-50, 350), (-33645, -36528.9)),
((-50, 375), (-33692.3, -38986.8)),
((-50, 400), (-33737.5, -41448.9)),
((-25, -400), (-36076.3, 35595.3)),
((-25, -375), (-36028.1, 33145.9)),
((-25, -350), (-35978.6, 30701.8)),
((-25, -325), (-35928.1, 28263.4)),
((-25, -300), (-35876.9, 25831.4)),
((-25, -275), (-35825.7, 23406.1)),
((-25, -250), (-35774.9, 20988)),
((-25, -225), (-35725.6, 18577.3)),
((-25, -200), (-35678.4, 16174.2)),
((-25, -175), (-35634.6, 13778.7)),
((-25, -150), (-35595.2, 11390.5)),
((-25, -125), (-35561.2, 9008.85)),
((-25, -100), (-35534, 6633.01)),
((-25, -75), (-35514.2, 4261.71)),
((-25, -50), (-35502.8, 1893.49)),
((-25, -25), (-35500.2, -473.335)),
((-25, 0), (-35506.4, -2840.51)),
((-25, 25), (-35521.2, -5209.77)),
((-25, 50), (-35544, -7582.72)),
((-25, 75), (-35574.1, -9960.74)),
((-25, 100), (-35610.3, -12344.9)),
((-25, 125), (-35651.7, -14736)),
((-25, 150), (-35697, -17134.5)),
((-25, 175), (-35745.1, -19540.7)),
((-25, 200), (-35795.1, -21954.3)),
((-25, 225), (-35846.1, -24375.4)),
((-25, 250), (-35897.4, -26803.4)),
((-25, 275), (-35948.4, -29238)),
((-25, 300), (-35998.6, -31678.7)),
((-25, 325), (-36047.6, -34125)),
((-25, 350), (-36095.2, -36576.4)),
((-25, 375), (-36141.2, -39032.5)),
((-25, 400), (-36185.5, -41492.7)),
((0, -400), (-38531.8, 35641.9)),
((0, -375), (-38485.5, 33193.7)),
((0, -350), (-38438.3, 30750.6)),
((0, -325), (-38390.4, 28312.9)),
((0, -300), (-38342.3, 25881.1)),
((0, -275), (-38294.5, 23455.4)),
((0, -250), (-38247.6, 21036.2)),
((0, -225), (-38202.2, 18623.6)),
((0, -200), (-38159.3, 16217.7)),
((0, -175), (-38119.7, 13818.4)),
((0, -150), (-38084.3, 11425.3)),
((0, -125), (-38054.1, 9037.85)),
((0, -100), (-38029.9, 6655.24)),
((0, -75), (-38012.5, 4276.41)),
((0, -50), (-38002.5, 1900.12)),
((0, -25), (-38000.2, -474.998)),
((0, 0), (-38005.6, -2850.42)),
((0, 25), (-38018.6, -5227.56)),
((0, 50), (-38038.8, -7607.76)),
((0, 75), (-38065.5, -9992.2)),
((0, 100), (-38097.9, -12381.8)),
((0, 125), (-38135.1, -14777.4)),
((0, 150), (-38176.2, -17179.3)),
((0, 175), (-38220.1, -19587.8)),
((0, 200), (-38266.2, -22003.1)),
((0, 225), (-38313.5, -24424.9)),
((0, 250), (-38361.5, -26853.1)),
((0, 275), (-38409.6, -29287.3)),
((0, 300), (-38457.3, -31727.2)),
((0, 325), (-38504.1, -34172.4)),
((0, 350), (-38550, -36622.5)),
((0, 375), (-38594.6, -39077)),
((0, 400), (-38637.8, -41535.6)),
((25, -400), (-40991.6, 35686.8)),
((25, -375), (-40947.2, 33239.5)),
((25, -350), (-40902.3, 30797)),
((25, -325), (-40857, 28359.6)),
((25, -300), (-40811.9, 25927.5)),
((25, -275), (-40767.3, 23501.1)),
((25, -250), (-40723.9, 21080.6)),
((25, -225), (-40682.2, 18666)),
((25, -200), (-40643, 16257.2)),
((25, -175), (-40607.1, 13854.2)),
((25, -150), (-40575.3, 11456.5)),
((25, -125), (-40548.2, 9063.71)),
((25, -100), (-40526.6, 6674.97)),
((25, -75), (-40511.1, 4289.42)),
((25, -50), (-40502.2, 1905.99)),
((25, -25), (-40500.1, -476.474)),
((25, 0), (-40505, -2859.18)),
((25, 25), (-40516.5, -5243.32)),
((25, 50), (-40534.5, -7630.03)),
((25, 75), (-40558.4, -10020.3)),
((25, 100), (-40587.5, -12415)),
((25, 125), (-40621.1, -14814.7)),
((25, 150), (-40658.4, -17220)),
((25, 175), (-40698.6, -19631.1)),
((25, 200), (-40741.1, -22048.1)),
((25, 225), (-40785, -24471)),
((25, 250), (-40829.9, -26899.7)),
((25, 275), (-40875.1, -29333.9)),
((25, 300), (-40920.3, -31773.4)),
((25, 325), (-40965, -34217.9)),
((25, 350), (-41009.1, -36666.9)),
((25, 375), (-41052.1, -39120.3)),
((25, 400), (-41094.1, -41577.5)),
((50, -400), (-43455.1, 35729.8)),
((50, -375), (-43412.8, 33283.1)),
((50, -350), (-43370.1, 30841)),
((50, -325), (-43327.4, 28403.5)),
((50, -300), (-43285, 25971)),
((50, -275), (-43243.5, 23543.7)),
((50, -250), (-43203.2, 21121.6)),
((50, -225), (-43164.9, 18704.8)),
((50, -200), (-43129.1, 16293.2)),
((50, -175), (-43096.4, 13886.6)),
((50, -150), (-43067.5, 11484.7)),
((50, -125), (-43043.1, 9086.88)),
((50, -100), (-43023.8, 6692.58)),
((50, -75), (-43009.9, 4300.99)),
((50, -50), (-43002, 1911.2)),
((50, -25), (-43000.1, -477.781)),
((50, 0), (-43004.4, -2866.96)),
((50, 25), (-43014.8, -5257.37)),
((50, 50), (-43030.9, -7649.94)),
((50, 75), (-43052.3, -10045.5)),
((50, 100), (-43078.6, -12444.9)),
((50, 125), (-43109, -14848.7)),
((50, 150), (-43143, -17257.2)),
((50, 175), (-43180, -19670.9)),
((50, 200), (-43219.1, -22089.8)),
((50, 225), (-43260, -24514)),
((50, 250), (-43301.9, -26943.4)),
((50, 275), (-43344.4, -29377.9)),
((50, 300), (-43387.2, -31817.3)),
((50, 325), (-43429.8, -34261.3)),
((50, 350), (-43471.9, -36709.6)),
((50, 375), (-43513.4, -39162.1)),
((50, 400), (-43554, -41618.3)),
((75, -400), (-45922.2, 35771)),
((75, -375), (-45881.8, 33324.7)),
((75, -350), (-45841.3, 30882.6)),
((75, -325), (-45801, 28444.8)),
((75, -300), (-45761.3, 26011.7)),
((75, -275), (-45722.5, 23583.2)),
((75, -250), (-45685.2, 21159.5)),
((75, -225), (-45649.8, 18740.5)),
((75, -200), (-45617, 16326.1)),
((75, -175), (-45587.1, 13916.1)),
((75, -150), (-45560.9, 11510.1)),
((75, -125), (-45538.8, 9107.76)),
((75, -100), (-45521.4, 6708.41)),
((75, -75), (-45508.9, 4311.37)),
((75, -50), (-45501.8, 1915.86)),
((75, -25), (-45500.1, -478.945)),
((75, 0), (-45504, -2873.93)),
((75, 25), (-45513.3, -5269.95)),
((75, 50), (-45527.8, -7667.84)),
((75, 75), (-45547.1, -10068.3)),
((75, 100), (-45570.9, -12472)),
((75, 125), (-45598.7, -14879.6)),
((75, 150), (-45629.8, -17291.3)),
((75, 175), (-45663.7, -19707.5)),
((75, 200), (-45699.9, -22128.4)),
((75, 225), (-45737.9, -24554)),
((75, 250), (-45777.1, -26984.4)),
((75, 275), (-45817.1, -29419.4)),
((75, 300), (-45857.5, -31858.9)),
((75, 325), (-45898, -34302.7)),
((75, 350), (-45938.3, -36750.6)),
((75, 375), (-45978.1, -39202.4)),
((75, 400), (-46017.3, -41657.8)),
((100, -400), (-48392.3, 35810.3)),
((100, -375), (-48353.8, 33364.2)),
((100, -350), (-48315.5, 30921.9)),
((100, -325), (-48277.5, 28483.7)),
((100, -300), (-48240.2, 26049.7)),
((100, -275), (-48204, 23620)),
((100, -250), (-48169.4, 21194.5)),
((100, -225), (-48136.7, 18773.3)),
((100, -200), (-48106.5, 16356.2)),
((100, -175), (-48079.1, 13943)),
((100, -150), (-48055.2, 11533.3)),
((100, -125), (-48035.1, 9126.68)),
((100, -100), (-48019.3, 6722.7)),
((100, -75), (-48008.1, 4320.72)),
((100, -50), (-48001.6, 1920.06)),
((100, -25), (-48000.1, -480.001)),
((100, 0), (-48003.6, -2880.21)),
((100, 25), (-48012, -5281.32)),
((100, 50), (-48025.1, -7684.02)),
((100, 75), (-48042.7, -10089)),
((100, 100), (-48064.4, -12496.7)),
((100, 125), (-48089.7, -14907.8)),
((100, 150), (-48118.2, -17322.6)),
((100, 175), (-48149.5, -19741.3)),
((100, 200), (-48183, -22164.2)),
((100, 225), (-48218.3, -24591.3)),
((100, 250), (-48255, -27022.8)),
((100, 275), (-48292.6, -29458.5)),
((100, 300), (-48330.8, -31898.3)),
((100, 325), (-48369.2, -34342.2)),
((100, 350), (-48407.7, -36789.8)),
((100, 375), (-48445.9, -39241.2)),
((100, 400), (-48483.6, -41695.9)),
((125, -400), (-50865.2, 35847.9)),
((125, -375), (-50828.6, 33401.6)),
((125, -350), (-50792.2, 30959.1)),
((125, -325), (-50756.4, 28520.3)),
((125, -300), (-50721.4, 26085.3)),
((125, -275), (-50687.6, 23654.2)),
((125, -250), (-50655.4, 21227)),
((125, -225), (-50625.1, 18803.6)),
((125, -200), (-50597.3, 16383.9)),
((125, -175), (-50572.2, 13967.6)),
((125, -150), (-50550.3, 11554.3)),
((125, -125), (-50532, 9143.88)),
((125, -100), (-50517.5, 6735.68)),
((125, -75), (-50507.3, 4329.2)),
((125, -50), (-50501.4, 1923.86)),
((125, -25), (-50500.1, -480.954)),
((125, 0), (-50503.3, -2885.91)),
((125, 25), (-50510.9, -5291.62)),
((125, 50), (-50522.8, -7698.71)),
((125, 75), (-50538.8, -10107.8)),
((125, 100), (-50558.6, -12519.3)),
((125, 125), (-50581.9, -14933.7)),
((125, 150), (-50608.1, -17351.4)),
((125, 175), (-50637, -19772.5)),
((125, 200), (-50668.1, -22197.4)),
((125, 225), (-50701, -24626.2)),
((125, 250), (-50735.3, -27058.8)),
((125, 275), (-50770.7, -29495.3)),
((125, 300), (-50806.7, -31935.7)),
((125, 325), (-50843.2, -34379.7)),
((125, 350), (-50879.9, -36827.3)),
((125, 375), (-50916.4, -39278.4)),
((125, 400), (-50952.7, -41732.7)),
((150, -400), (-53340.6, 35883.6)),
((150, -375), (-53305.7, 33437.2)),
((150, -350), (-53271.3, 30994.2)),
((150, -325), (-53237.5, 28554.7)),
((150, -300), (-53204.7, 26118.7)),
((150, -275), (-53173.1, 23686.2)),
((150, -250), (-53143, 21257.2)),
((150, -225), (-53115, 18831.7)),
((150, -200), (-53089.2, 16409.4)),
((150, -175), (-53066.1, 13990.2)),
((150, -150), (-53046, 11573.7)),
((150, -125), (-53029.2, 9159.59)),
((150, -100), (-53016, 6747.49)),
((150, -75), (-53006.7, 4336.91)),
((150, -50), (-53001.3, 1927.32)),
((150, -25), (-53000.1, -481.814)),
((150, 0), (-53003, -2891.07)),
((150, 25), (-53009.9, -5300.99)),
((150, 50), (-53020.8, -7712.12)),
((150, 75), (-53035.5, -10125)),
((150, 100), (-53053.6, -12539.9)),
((150, 125), (-53075, -14957.5)),
((150, 150), (-53099.2, -17377.9)),
((150, 175), (-53125.9, -19801.5)),
((150, 200), (-53154.8, -22228.4)),
((150, 225), (-53185.5, -24658.7)),
((150, 250), (-53217.7, -27092.6)),
((150, 275), (-53250.9, -29530.1)),
((150, 300), (-53285, -31971)),
((150, 325), (-53319.6, -34415.4)),
((150, 350), (-53354.5, -36863.1)),
((150, 375), (-53389.5, -39314.1)),
((150, 400), (-53424.4, -41768.2)),
((175, -400), (-55818.1, 35917.7)),
((175, -375), (-55785, 33471)),
((175, -350), (-55752.4, 31027.4)),
((175, -325), (-55720.5, 28587)),
((175, -300), (-55689.6, 26149.9)),
((175, -275), (-55660.1, 23716)),
((175, -250), (-55632.1, 21285.3)),
((175, -225), (-55606, 18857.7)),
((175, -200), (-55582.1, 16433)),
((175, -175), (-55560.7, 14011)),
((175, -150), (-55542.2, 11591.4)),
((175, -125), (-55526.8, 9173.98)),
((175, -100), (-55514.7, 6758.31)),
((175, -75), (-55506.1, 4343.96)),
((175, -50), (-55501.2, 1930.47)),
((175, -25), (-55500.1, -482.614)),
((175, 0), (-55502.7, -2895.79)),
((175, 25), (-55509.1, -5309.57)),
((175, 50), (-55519.1, -7724.39)),
((175, 75), (-55532.5, -10140.7)),
((175, 100), (-55549.2, -12559)),
((175, 125), (-55568.9, -14979.4)),
((175, 150), (-55591.3, -17402.5)),
((175, 175), (-55616.2, -19828.4)),
((175, 200), (-55643, -22257.2)),
((175, 225), (-55671.7, -24689.2)),
((175, 250), (-55701.9, -27124.4)),
((175, 275), (-55733.2, -29562.8)),
((175, 300), (-55765.4, -32004.5)),
((175, 325), (-55798.2, -34449.3)),
((175, 350), (-55831.4, -36897.3)),
((175, 375), (-55864.9, -39348.3)),
((175, 400), (-55898.3, -41802.2)),
((200, -400), (-58297.7, 35950.2)),
((200, -375), (-58266.2, 33503.1)),
((200, -350), (-58235.3, 31058.8)),
((200, -325), (-58205.2, 28617.6)),
((200, -300), (-58176.2, 26179.3)),
((200, -275), (-58148.4, 23743.9)),
((200, -250), (-58122.2, 21311.5)),
((200, -225), (-58097.9, 18881.8)),
((200, -200), (-58075.7, 16454.8)),
((200, -175), (-58056, 14030.2)),
((200, -150), (-58038.8, 11607.8)),
((200, -125), (-58024.6, 9187.23)),
((200, -100), (-58013.5, 6768.24)),
((200, -75), (-58005.6, 4350.42)),
((200, -50), (-58001.1, 1933.37)),
((200, -25), (-58000.1, -483.333)),
((200, 0), (-58002.5, -2900.12)),
((200, 25), (-58008.3, -5317.44)),
((200, 50), (-58017.5, -7735.67)),
((200, 75), (-58029.9, -10155.2)),
((200, 100), (-58045.4, -12576.5)),
((200, 125), (-58063.6, -14999.8)),
((200, 150), (-58084.3, -17425.3)),
((200, 175), (-58107.4, -19853.4)),
((200, 200), (-58132.5, -22284.1)),
((200, 225), (-58159.3, -24717.7)),
((200, 250), (-58187.6, -27154.2)),
((200, 275), (-58217.1, -29593.7)),
((200, 300), (-58247.6, -32036.2)),
((200, 325), (-58278.7, -34481.6)),
((200, 350), (-58310.4, -36929.9)),
((200, 375), (-58342.3, -39381.1)),
((200, 400), (-58374.4, -41835)),
((225, -400), (-60779, 35981.2)),
((225, -375), (-60749, 33533.5)),
((225, -350), (-60719.8, 31088.5)),
((225, -325), (-60691.3, 28646.3)),
((225, -300), (-60664, 26206.9)),
((225, -275), (-60638, 23770.1)),
((225, -250), (-60613.5, 21335.9)),
((225, -225), (-60590.8, 18904.3)),
((225, -200), (-60570.1, 16475.1)),
((225, -175), (-60551.7, 14048)),
((225, -150), (-60535.9, 11622.9)),
((225, -125), (-60522.7, 9199.46)),
((225, -100), (-60512.4, 6777.39)),
((225, -75), (-60505.2, 4356.37)),
((225, -50), (-60501, 1936.03)),
((225, -25), (-60500.1, -483.999)),
((225, 0), (-60502.3, -2904.12)),
((225, 25), (-60507.7, -5324.68)),
((225, 50), (-60516.2, -7746.08)),
((225, 75), (-60527.6, -10168.6)),
((225, 100), (-60541.9, -12592.7)),
((225, 125), (-60558.8, -15018.6)),
((225, 150), (-60578.1, -17446.5)),
((225, 175), (-60599.6, -19876.7)),
((225, 200), (-60623.1, -22309.3)),
((225, 225), (-60648.2, -24744.5)),
((225, 250), (-60674.8, -27182.3)),
((225, 275), (-60702.6, -29622.9)),
((225, 300), (-60731.4, -32066.2)),
((225, 325), (-60761, -34512.2)),
((225, 350), (-60791.1, -36961)),
((225, 375), (-60821.6, -39412.4)),
((225, 400), (-60852.3, -41866.4)),
((250, -400), (-63261.9, 36010.6)),
((250, -375), (-63233.4, 33562.3)),
((250, -350), (-63205.7, 31116.6)),
((250, -325), (-63178.8, 28673.4)),
((250, -300), (-63153, 26232.8)),
((250, -275), (-63128.5, 23794.6)),
((250, -250), (-63105.6, 21358.8)),
((250, -225), (-63084.3, 18925.3)),
((250, -200), (-63065.1, 16493.9)),
((250, -175), (-63048, 14064.6)),
((250, -150), (-63033.2, 11636.9)),
((250, -125), (-63021, 9210.76)),
((250, -100), (-63011.5, 6785.86)),
((250, -75), (-63004.8, 4361.87)),
((250, -50), (-63000.9, 1938.49)),
((250, -25), (-63000.1, -484.622)),
((250, 0), (-63002.1, -2907.79)),
((250, 25), (-63007.1, -5331.38)),
((250, 50), (-63015, -7755.69)),
((250, 75), (-63025.6, -10181.1)),
((250, 100), (-63038.8, -12607.8)),
((250, 125), (-63054.6, -15036.1)),
((250, 150), (-63072.5, -17466.2)),
((250, 175), (-63092.6, -19898.4)),
((250, 200), (-63114.6, -22332.8)),
((250, 225), (-63138.1, -24769.6)),
((250, 250), (-63163.2, -27208.7)),
((250, 275), (-63189.4, -29650.4)),
((250, 300), (-63216.7, -32094.6)),
((250, 325), (-63244.7, -34541.3)),
((250, 350), (-63273.4, -36990.6)),
((250, 375), (-63302.5, -39442.3)),
((250, 400), (-63332, -41896.5)),
((275, -400), (-65746.2, 36038.7)),
((275, -375), (-65719.1, 33589.8)),
((275, -350), (-65692.8, 31143.3)),
((275, -325), (-65667.4, 28699.1)),
((275, -300), (-65643, 26257.2)),
((275, -275), (-65620, 23817.6)),
((275, -250), (-65598.5, 21380.2)),
((275, -225), (-65578.6, 18944.9)),
((275, -200), (-65560.6, 16511.5)),
((275, -175), (-65544.6, 14080)),
((275, -150), (-65530.9, 11649.9)),
((275, -125), (-65519.5, 9221.27)),
((275, -100), (-65510.7, 6793.7)),
((275, -75), (-65504.4, 4366.95)),
((275, -50), (-65500.9, 1940.77)),
((275, -25), (-65500.1, -485.19)),
((275, 0), (-65502, -2911.19)),
((275, 25), (-65506.6, -5337.57)),
((275, 50), (-65513.9, -7764.61)),
((275, 75), (-65523.8, -10192.6)),
((275, 100), (-65536.1, -12621.8)),
((275, 125), (-65550.7, -15052.4)),
((275, 150), (-65567.5, -17484.7)),
((275, 175), (-65586.3, -19918.8)),
((275, 200), (-65606.9, -22354.9)),
((275, 225), (-65629.1, -24793.2)),
((275, 250), (-65652.6, -27233.7)),
((275, 275), (-65677.4, -29676.5)),
((275, 300), (-65703.2, -32121.6)),
((275, 325), (-65729.9, -34569)),
((275, 350), (-65757.2, -37018.9)),
((275, 375), (-65785, -39471)),
((275, 400), (-65813.2, -41925.4)),
((300, -400), (-68231.8, 36065.4)),
((300, -375), (-68206, 33615.8)),
((300, -350), (-68181, 31168.5)),
((300, -325), (-68157, 28723.3)),
((300, -300), (-68134, 26280.3)),
((300, -275), (-68112.3, 23839.3)),
((300, -250), (-68092, 21400.4)),
((300, -225), (-68073.4, 18963.3)),
((300, -200), (-68056.5, 16528)),
((300, -175), (-68041.6, 14094.3)),
((300, -150), (-68028.8, 11662.1)),
((300, -125), (-68018.2, 9231.04)),
((300, -100), (-68009.9, 6800.99)),
((300, -75), (-68004.1, 4371.7)),
((300, -50), (-68000.8, 1942.88)),
((300, -25), (-68000.1, -485.712)),
((300, 0), (-68001.8, -2914.36)),
((300, 25), (-68006.1, -5343.34)),
((300, 50), (-68012.9, -7772.91)),
((300, 75), (-68022.1, -10203.3)),
((300, 100), (-68033.6, -12634.8)),
((300, 125), (-68047.3, -15067.6)),
((300, 150), (-68063, -17501.9)),
((300, 175), (-68080.6, -19937.9)),
((300, 200), (-68099.9, -22375.7)),
((300, 225), (-68120.8, -24815.4)),
((300, 250), (-68143, -27257.2)),
((300, 275), (-68166.5, -29701.1)),
((300, 300), (-68190.9, -32147.2)),
((300, 325), (-68216.3, -34595.4)),
((300, 350), (-68242.3, -37045.8)),
((300, 375), (-68268.9, -39498.4)),
((300, 400), (-68295.9, -41953.2)),
((325, -400), (-70718.6, 36090.9)),
((325, -375), (-70694, 33640.6)),
((325, -350), (-70670.3, 31192.4)),
((325, -325), (-70647.5, 28746.2)),
((325, -300), (-70625.8, 26302)),
((325, -275), (-70605.3, 23859.7)),
((325, -250), (-70586.2, 21419.3)),
((325, -225), (-70568.6, 18980.5)),
((325, -200), (-70552.8, 16543.4)),
((325, -175), (-70538.8, 14107.8)),
((325, -150), (-70526.9, 11673.4)),
((325, -125), (-70517, 9240.15)),
((325, -100), (-70509.3, 6807.79)),
((325, -75), (-70503.8, 4376.1)),
((325, -50), (-70500.8, 1944.85)),
((325, -25), (-70500, -486.205)),
((325, 0), (-70501.7, -2917.32)),
((325, 25), (-70505.7, -5348.72)),
((325, 50), (-70512.1, -7780.64)),
((325, 75), (-70520.6, -10213.3)),
((325, 100), (-70531.4, -12647)),
((325, 125), (-70544.2, -15081.9)),
((325, 150), (-70558.9, -17518.1)),
((325, 175), (-70575.5, -19955.8)),
((325, 200), (-70593.6, -22395.2)),
((325, 225), (-70613.3, -24836.4)),
((325, 250), (-70634.3, -27279.5)),
((325, 275), (-70656.5, -29724.5)),
((325, 300), (-70679.7, -32171.5)),
((325, 325), (-70703.8, -34620.5)),
((325, 350), (-70728.6, -37071.5)),
((325, 375), (-70754, -39524.6)),
((325, 400), (-70779.8, -41979.7)),
((350, -400), (-73206.4, 36115.1)),
((350, -375), (-73183, 33664.2)),
((350, -350), (-73160.4, 31215.1)),
((350, -325), (-73138.8, 28767.9)),
((350, -300), (-73118.2, 26322.6)),
((350, -275), (-73098.9, 23879)),
((350, -250), (-73080.9, 21437.1)),
((350, -225), (-73064.4, 18996.7)),
((350, -200), (-73049.5, 16557.9)),
((350, -175), (-73036.4, 14120.4)),
((350, -150), (-73025.1, 11684)),
((350, -125), (-73015.9, 9248.68)),
((350, -100), (-73008.7, 6814.14)),
((350, -75), (-73003.6, 4380.21)),
((350, -50), (-73000.7, 1946.69)),
((350, -25), (-73000, -486.667)),
((350, 0), (-73001.6, -2920.06)),
((350, 25), (-73005.4, -5353.73)),
((350, 50), (-73011.3, -7787.88)),
((350, 75), (-73019.3, -10222.7)),
((350, 100), (-73029.4, -12658.4)),
((350, 125), (-73041.4, -15095.2)),
((350, 150), (-73055.2, -17533.3)),
((350, 175), (-73070.8, -19972.7)),
((350, 200), (-73087.9, -22413.6)),
((350, 225), (-73106.5, -24856.2)),
((350, 250), (-73126.3, -27300.5)),
((350, 275), (-73147.3, -29746.6)),
((350, 300), (-73169.4, -32194.5)),
((350, 325), (-73192.3, -34644.3)),
((350, 350), (-73215.9, -37096.1)),
((350, 375), (-73240.2, -39549.7)),
((350, 400), (-73264.9, -42005.2)),
((375, -400), (-75695.1, 36138.3)),
((375, -375), (-75672.9, 33686.6)),
((375, -350), (-75651.4, 31236.7)),
((375, -325), (-75630.8, 28788.5)),
((375, -300), (-75611.3, 26342)),
((375, -275), (-75593, 23897.1)),
((375, -250), (-75576, 21453.8)),
((375, -225), (-75560.5, 19012)),
((375, -200), (-75546.4, 16571.5)),
((375, -175), (-75534.1, 14132.2)),
((375, -150), (-75523.6, 11694)),
((375, -125), (-75514.9, 9256.67)),
((375, -100), (-75508.1, 6820.1)),
((375, -75), (-75503.4, 4384.06)),
((375, -50), (-75500.7, 1948.4)),
((375, -25), (-75500, -487.097)),
((375, 0), (-75501.5, -2922.63)),
((375, 25), (-75505, -5358.41)),
((375, 50), (-75510.6, -7794.65)),
((375, 75), (-75518.1, -10231.5)),
((375, 100), (-75527.6, -12669.1)),
((375, 125), (-75538.8, -15107.8)),
((375, 150), (-75551.9, -17547.5)),
((375, 175), (-75566.5, -19988.6)),
((375, 200), (-75582.6, -22431)),
((375, 225), (-75600.2, -24874.9)),
((375, 250), (-75619, -27320.4)),
((375, 275), (-75638.9, -29767.6)),
((375, 300), (-75659.9, -32216.5)),
((375, 325), (-75681.7, -34667.1)),
((375, 350), (-75704.2, -37119.5)),
((375, 375), (-75727.4, -39573.7)),
((375, 400), (-75751.2, -42029.7)),
((400, -400), (-78184.7, 36160.5)),
((400, -375), (-78163.5, 33708)),
((400, -350), (-78143, 31257.2)),
((400, -325), (-78123.5, 28808)),
((400, -300), (-78105, 26360.4)),
((400, -275), (-78087.7, 23914.3)),
((400, -250), (-78071.6, 21469.7)),
((400, -225), (-78056.9, 19026.4)),
((400, -200), (-78043.7, 16584.3)),
((400, -175), (-78032.1, 14143.3)),
((400, -150), (-78022.1, 11703.3)),
((400, -125), (-78014, 9264.15)),
((400, -100), (-78007.6, 6825.67)),
((400, -75), (-78003.2, 4387.69)),
((400, -50), (-78000.6, 1950.01)),
((400, -25), (-78000, -487.492)),
((400, 0), (-78001.4, -2925.05)),
((400, 25), (-78004.7, -5362.83)),
((400, 50), (-78009.9, -7800.99)),
((400, 75), (-78017, -10239.7)),
((400, 100), (-78025.9, -12679.2)),
((400, 125), (-78036.5, -15119.6)),
((400, 150), (-78048.8, -17561)),
((400, 175), (-78062.6, -20003.5)),
((400, 200), (-78077.9, -22447.4)),
((400, 225), (-78094.5, -24892.6)),
((400, 250), (-78112.3, -27339.3)),
((400, 275), (-78131.2, -29787.5)),
((400, 300), (-78151.1, -32237.3)),
((400, 325), (-78171.9, -34688.8)),
((400, 350), (-78193.5, -37141.9)),
((400, 375), (-78215.6, -39596.7)),
((400, 400), (-78238.4, -42053.1))]

OBSTACLES = [((-274.32, -274.32), (-205.68, -274.32), (-205.68, -205.68), (-274.32, -205.68)), 
((205.68, 205.68), (274.32, 205.68), (274.32, 274.32), (205.68, 274.32)), 
((205.68, -274.32), (274.32, -274.32), (274.32, -205.68), (205.68, -205.68)), 
((-274.32, 205.68), (-205.68, 205.68), (-205.68, 274.32), (-274.32, 274.32)), 
((-154.32, -274.32), (-85.68, -274.32), (-85.68, -205.68), (-154.32, -205.68)), 
((85.68, 205.68), (154.32, 205.68), (154.32, 274.32), (85.68, 274.32)), 
((205.68, -154.32), (274.32, -154.32), (274.32, -85.68), (205.68, -85.68)), 
((-274.32, 85.68), (-205.68, 85.68), (-205.68, 154.32), (-274.32, 154.32)), 
((-274.32, -154.32), (-205.68, -154.32), (-205.68, -85.68), (-274.32, -85.68)), 
((205.68, 85.68), (274.32, 85.68), (274.32, 154.32), (205.68, 154.32)), 
((85.68, 274.32), (154.32, -274.32), (154.32, -205.68), (85.68, -205.68)), 
((-154.32, 205.68), (-85.68, 205.68), (-85.68, 274.32), (-154.32, 274.32)), 
((-154.32, -154.32), (-85.68, -154.32), (-85.68, -85.68), (-154.32, -85.68)), 
((85.68, 85.68), (154.32, 85.68), (154.32, 154.32), (85.68, 154.32)), 
((85.68, -154.32), (154.32, -154.32), (154.32, -85.68), (85.68, -85.68)), 
((-154.32, 85.68), (-85.68, 85.68), (-85.68, 154.32), (-154.32, 154.32)), 
((-274.32, -34.32), (-205.68, -34.32), (-205.68, 34.32), (-274.32, 34.32)), 
((205.68, -34.32), (274.32, -34.32), (274.32, 34.32), (205.68, 34.32)), 
((-34.32, -274.32), (34.32, -274.32), (34.32, -205.68), (-34.32, -205.68)), 
((-34.32, 205.68), (34.32, 205.68), (34.32, 274.32), (-34.32, 274.32)), 
((-154.32, -34.32), (-85.68, -34.32), (-85.68, 34.3), (-154.32, 34.32)), 
((85.68, -34.32), (154.32, -34.32), (154.32, 34.32), (85.68, 34.32)), 
((-34.32, -154.32), (34.32, -154.32), (34.32, -85.68), (-34.32, -85.68)), 
((-34.32, 85.68), (34.32, 85.68), (34.32, 154.32), (-34.32, 154.32)), 
((-360.72, -50.72), (-335.68, -50.72), (-335.68, -25.68), (-360.72, -25.68)), 
((-344.32, -34.32), (-319.28, -34.32), (-319.28, -9.28), (-344.32, -9.28)), 
((-344.32, 9.28), (-319.28, 9.28), (-319.28, 34.32), (-344.32, 34.32)), 
((-360.72, 25.68), (-335.68, 25.68), (-335.68, 50.72), (-360.72, 50.72)), 
((335.68, -50.72), (360.72, -50.72), (360.72, -25.68), (335.68, -25.68)), 
((319.28, -34.32), (344.32, -34.32), (344.32, -9.28), (319.28, -9.28)), 
((319.28, 9.28), (344.32, 9.28), (344.32, 34.32), (319.28, 34.32)), 
((335.68, 25.68), (360.72, 25.68), (360.72, 50.72), (335.68, 50.72)), 
((-50.72, -360.72), (-25.68, -360.72), (-25.68, -335.68), (-50.72, -335.68)), 
((-34.32, -344.32), (-9.28, -344.32), (-9.28, -319.28), (-34.32, -319.28)), 
((9.28, -344.32), (34.32, -344.32), (34.32, -319.28), (9.28, -319.28)), 
((25.68, -360.72), (50.72, -360.72), (50.72, -335.68), (25.68, -335.68)), 
((-50.72, 335.68), (-25.68, 335.68), (-25.68, 360.72), (-50.72, 360.72)), 
((-34.32, 319.28), (-9.28, 319.28), (-9.28, 344.32), (-34.32, 344.32)), 
((9.28, 319.28), (34.32, 319.28), (34.32, 344.32), (9.28, 344.32)), 
((25.68, 335.68), (50.72, 335.68), (50.72, 360.72), (25.68, 360.72)), 
((-57.52, -57.52), (-32.48, -57.52), (-32.48, -32.48), (-57.52, -32.48)), 
((32.48, -57.52), (57.52, -57.52), (57.52, -32.48), (32.48, -32.48)), 
((-5.52, 32.48), (-32.48, 32.48), (-32.48, 57.52), (-57.52, 57.52)), 
((32.48, 32.48), (57.52, 32.48), (57.52, 57.52), (32.48, 57.52)), 
((-12.52, -72.52), (12.52, -72.52), (12.52, -47.48), (-12.52, -47.48)), 
((-12.52, 47.48), (12.52, 47.48), (12.52, 72.52), (-12.52, 72.52)), 
((-72.52, -12.52), (-47.48, -12.52), (-47.48, 12.52), (-72.52, 12.52)), 
((47.48, -12.52), (72.52, -12.52), (72.52, 12.52), (47.48, 12.52)), 
((-12.52, -192.52), (12.52, -192.52), (12.52, -167.48), (-12.52, -167.48)), 
((-12.52, 167.48), (12.52, 167.48), (12.52, 192.52), (-12.52, 192.52)), 
((-192.52, -12.52), (-167.48, -12.52), (-167.48, 12.52), (-192.52, 12.52)), 
((167.48, -12.52), (192.52, -12.52), (192.52, 12.52), (167.48, 12.52))]


########################################################################
# Helper Functions

def gpi_point(x, y, vec_x, vec_y):
    '''Create the centered gpi data point (4-tuple) for a position and
    vector.  The vectors are expected to be less than 1 in magnitude,
    and larger values will be scaled down.'''
    r = (vec_x ** 2 + vec_y ** 2) ** 0.5
    if r > 1:
        vec_x /= r
        vec_y /= r
    return (x - vec_x * VEC_LEN / 2, y - vec_y * VEC_LEN / 2,
            vec_x * VEC_LEN, vec_y * VEC_LEN)

def gnuplot_header(minimum, maximum):
    '''Return a string that has all of the gnuplot sets and unsets.'''
    s = ''
    s += 'set xrange [%s: %s]\n' % (minimum, maximum)
    s += 'set yrange [%s: %s]\n' % (minimum, maximum)
    # The key is just clutter.  Get rid of it:
    s += 'unset key\n'
    # Make sure the figure is square since the world is square:
    s += 'set size square\n'
    # Add a pretty title (optional):
    #s += "set title 'Potential Fields'\n"
    return s

def draw_line(p1, p2):
    '''Return a string to tell Gnuplot to draw a line from point p1 to
    point p2 in the form of a set command.'''
    x1, y1 = p1
    x2, y2 = p2
    return 'set arrow from %s, %s to %s, %s nohead lt 3\n' % (x1, y1, x2, y2)

def draw_obstacles(obstacles):
    '''Return a string which tells Gnuplot to draw all of the obstacles.'''
    s = 'unset arrow\n'

    for obs in obstacles:
        last_point = obs[0]
        for cur_point in obs[1:]:
            s += draw_line(last_point, cur_point)
            last_point = cur_point
        s += draw_line(last_point, obs[0])
    return s

def plot_field(function):
    '''Return a Gnuplot command to plot a field.'''
    s = "plot '-' with vectors head\n"

    separation = WORLDSIZE / SAMPLES
    end = WORLDSIZE / 2 - separation / 2
    start = -end

    points = ((x, y) for x in linspace(start, end, SAMPLES)
                for y in linspace(start, end, SAMPLES))

    for loc, forces in POINTS:
        '''f_x, f_y = function(x, y)'''
        x, y = loc
        f_x, f_y = forces
        plotvalues = gpi_point(x, y, f_x, f_y)
        if plotvalues is not None:
            x1, y1, x2, y2 = plotvalues
            s += '%s %s %s %s\n' % (x1, y1, x2, y2)
    s += 'e\n'
    return s


########################################################################
# Plot the potential fields to a file

outfile = open(FILENAME, 'w')
print >>outfile, gnuplot_header(-WORLDSIZE / 2, WORLDSIZE / 2)
print >>outfile, draw_obstacles(OBSTACLES)
field_function = generate_field_function(150)
print >>outfile, plot_field(field_function)


########################################################################
# Animate a changing field, if the Python Gnuplot library is present

try:
    from Gnuplot import GnuplotProcess
except ImportError:
    print "Sorry.  You don't have the Gnuplot module installed."
    import sys
    sys.exit(-1)

forward_list = list(linspace(ANIMATION_MIN, ANIMATION_MAX, ANIMATION_FRAMES/2))
backward_list = list(linspace(ANIMATION_MAX, ANIMATION_MIN, ANIMATION_FRAMES/2))
anim_points = forward_list + backward_list

gp = GnuplotProcess(persist=False)
gp.write(gnuplot_header(-WORLDSIZE / 2, WORLDSIZE / 2))
gp.write(draw_obstacles(OBSTACLES))
for scale in cycle(anim_points):
    field_function = generate_field_function(scale)
    gp.write(plot_field(field_function))

# vim: et sw=4 sts=4

